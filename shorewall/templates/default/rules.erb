# Generated by Chef
# For information on entries in this file, type "man shorewall-rules"

#ACTION         SOURCE          DEST            PROTO   DEST    SOURCE          ORIGINAL        RATE            USER/
#                                                       PORT    PORT(S)         DEST            LIMIT           GROUP

<% (node[:shorewall][:allowed_ports] - node[:shorewall][:blocked_ports]).each do |port| -%>
ACCEPT net                 $FW tcp <%= port %>
<% end -%>

# Monitoring
<% node[:shorewall][:allowed_hosts].each do |host| -%>
ACCEPT  net:<%= host %> $FW
<% end -%>

# Allow connections from host A to port B on server
<% node[:shorewall][:allowed_connections].each do |connection|
    hosts = connection[0]
    ports = connection[1] -%>
ACCEPT	net:<%= hosts %>	$FW	tcp	<%= ports %>
<% end -%>

# Drop stuff without logging

# Popup spam
DROP    net     $FW     udp     1026:1027

# ms-sql server
DROP    net     $FW     tcp     1433:1434
DROP    net     $FW     udp     1433:1434

# Attack against Symmantec antivirus
DROP    net     $FW     tcp     2967
DROP    net     $FW     udp     2967

# Reject Ping from the "bad" net zone.. and prevent your log from being flooded..

Ping/REJECT     net             $FW

#LAST LINE -- ADD YOUR ENTRIES BEFORE THIS ONE -- DO NOT REMOVE
