# Generated by Chef, do not edit


# Allow services
<% unless node[:shorewall][:allowed_services][:tcp].empty? -%>
ACCEPT net $FW tcp <%= node[:shorewall][:allowed_services][:tcp].join(',') %>
<% end -%>
<% unless node[:shorewall][:allowed_services][:udp].empty? -%>
ACCEPT net $FW udp <%= node[:shorewall][:allowed_services][:udp].join(',') %>
<% end -%>

# Allow connections from certain hosts to certain ports
<% node[:shorewall][:allowed_connections].each do |connection| -%>
ACCEPT net:<%= connection[:hosts].join(',') %> $FW tcp <%= connection[:ports].join(',') %>
<% end -%>


# Drop stuff without logging

# Popup spam
DROP    net     $FW     udp     1026:1027

# ms-sql server
DROP    net     $FW     tcp     1433:1434
DROP    net     $FW     udp     1433:1434

# Attack against Symmantec antivirus
DROP    net     $FW     tcp     2967
DROP    net     $FW     udp     2967

# Reject Ping from the "bad" net zone.. and prevent your log from being flooded..

Ping/REJECT     net             $FW

#LAST LINE -- ADD YOUR ENTRIES BEFORE THIS ONE -- DO NOT REMOVE
